# 工具文件夹

这个文件夹包含了项目的分析工具和数据处理脚本。

## 文件说明

### analyze_certificates.py
- **功能**: 分析证书信息内容，帮助改进分类算法
- **描述**: 
  - 分析当前数据库中的证书信息
  - 统计已分类和未分类的人员数量
  - 显示未分类人员的证书信息详情
  - 提供分类改进建议
- **运行方式**: `python analyze_certificates.py`
- **依赖**: requests, pandas

### data_import.py
- **功能**: 数据导入脚本 - 从Excel文件导入数据到CRM系统
- **描述**:
  - 从Excel文件读取人才和企业信息
  - 自动处理和清洗数据
  - 批量导入到CRM系统
  - 支持数据验证和错误处理
- **运行方式**: `python data_import.py [excel_file_path]`
- **依赖**: pandas, requests
- **支持格式**: Excel (.xlsx, .xls)

### smart_import.py
- **功能**: 智能数据导入脚本 - 分析证书信息并自动分类
- **描述**:
  - 智能识别证书等级（一级、二级、高级工程师等）
  - 自动提取证书专业（建筑工程、电气工程师等）
  - 识别社保状态（唯一社保、无社保等）
  - 支持多种证书类型的自动分类
- **运行方式**: `python smart_import.py [excel_file_path]`
- **依赖**: pandas, requests, re

## 使用指南

### 数据导入流程

1. **准备Excel文件**
   - 确保Excel文件包含必要的列：姓名、身份证、电话、证书信息等
   - 数据格式要规范，避免特殊字符

2. **选择导入方式**
   - 使用 `data_import.py` 进行基础数据导入
   - 使用 `smart_import.py` 进行智能分类导入（推荐）

3. **运行导入脚本**
   ```bash
   cd tools
   python smart_import.py ../意向客户表.xlsx
   ```

### 数据分析流程

1. **运行分析工具**
   ```bash
   cd tools  
   python analyze_certificates.py
   ```

2. **查看分析结果**
   - 查看分类统计信息
   - 识别需要手动处理的数据
   - 获取分类改进建议

## 前提条件

1. **服务运行**
   - 确保后端API服务正在运行 (http://localhost:8000)
   - 数据库服务正常

2. **依赖安装**
   ```bash
   pip install pandas requests openpyxl
   ```

3. **文件准备**
   - Excel数据文件放在项目根目录
   - 确保文件格式正确

## 证书识别规则

### 支持的证书等级
- **建造师**: 一级、二级
- **工程师**: 高级工程师、中级工程师、初级工程师
- **其他**: 注册类证书、职业资格证书

### 支持的专业类型
- 建筑工程、市政工程、机电工程
- 电气工程师、结构工程师、给排水工程师
- 更多专业类型持续更新中

### 社保状态识别
- 唯一社保、无社保、转社保
- 自动识别关键词并分类

## 注意事项

- 导入前请备份现有数据
- 大批量数据导入建议分批处理
- 定期运行分析工具检查数据质量
- 如遇到识别错误，可手动调整分类规则
