# CRM数据导入工具使用说明

## 概述
这个工具可以将Excel文件中的数据导入到CRM系统中，支持人才数据和公司数据的导入。

## 环境要求
- Python 3.6+
- 依赖包：pandas, openpyxl, requests
- CRM后端服务运行在 http://localhost:8000

## 安装依赖
```bash
pip install pandas openpyxl requests
```

## 使用方法

### 1. 准备Excel文件
将Excel文件命名为 `意向客户表.xlsx` 并放在脚本同目录下。

### 2. 运行导入脚本
```bash
python data_import.py
```

### 3. 选择导入类型
- **选项1**: 人才数据导入
- **选项2**: 公司数据导入  
- **选项3**: 预览数据结构
- **选项4**: 清空现有数据后重新导入

## Excel文件格式要求

### 人才数据格式
脚本会自动识别以下列结构：
- 第1列：姓名 (必填)
- 第2列：身份证号码 (可选)
- 第3列：电话号码 (可选)
- 第4列：证书信息 (可选)
- 第5列：备注信息 (可选)

### 数据映射规则

#### 人才数据映射
- **姓名**: 直接映射到 `name` 字段
- **电话**: 映射到 `phone` 字段，自动处理科学计数法格式
- **证书信息**: 映射到 `certificate_info` 字段
- **备注**: 如果有证书信息则合并，否则映射到 `wechat_note` 字段
- **意向等级**: 根据证书信息自动判断
  - 包含"一建"或"一级建造师" → A级
  - 包含"二建"或"二级建造师" → B级
  - 其他 → C级

#### 公司数据映射
- **公司名称**: 映射到 `name` 字段 (必填)
- **联系方式**: 映射到 `contact_info` 字段
- **沟通意向**: 映射到 `intention` 字段
- **意向等级**: 映射到 `intention_level` 字段
- **价格**: 映射到 `price` 字段
- **证书需求**: 映射到 `certificate_requirements` 字段
- **备注**: 映射到 `communication_notes` 字段

## 导入结果
- ✓ 成功导入的记录会显示绿色勾号
- ✗ 失败的记录会显示红色叉号和原因
- 最后会显示导入统计信息

## 注意事项
1. **必填字段**: 人才数据必须有姓名，公司数据必须有公司名称
2. **数据清理**: 脚本会自动清理空值和格式化数据
3. **重复数据**: 目前不检查重复数据，请手动确保数据唯一性
4. **API连接**: 确保CRM后端服务正在运行
5. **数据备份**: 建议在导入前备份现有数据

## 常见问题

### Q: 导入失败怎么办？
A: 检查以下几点：
- 后端服务是否正常运行
- Excel文件格式是否正确
- 必填字段是否为空
- 网络连接是否正常

### Q: 如何处理重复数据？
A: 目前脚本不自动处理重复数据，建议：
- 导入前清理Excel文件中的重复记录
- 或在CRM系统中手动删除重复记录

### Q: 支持哪些Excel格式？
A: 支持 .xlsx 和 .xls 格式，推荐使用 .xlsx

### Q: 如何自定义字段映射？
A: 修改脚本中的 `map_excel_to_talent()` 和 `map_excel_to_company()` 函数

## 技术支持
如有问题，请检查：
1. Python环境和依赖包是否正确安装
2. CRM后端API是否正常响应
3. Excel文件格式是否符合要求
4. 控制台错误信息

## 更新日志
- v1.0: 基础导入功能
- v1.1: 添加数据预览和API连接检查
- v1.2: 优化电话号码格式处理
- v1.3: 添加意向等级自动判断
